/*! skrollr-stylesheets 0.0.6 (2014-04-06) | Alexander Prinzhorn - https://github.com/Prinzhorn/skrollr-stylesheets | Free to use under terms of MIT license */
define(function(){"use strict";function a(){for(var a,b=document.body.querySelectorAll("*"),c=[],d=0,e=b.length;e>d;d++){a=b[d];for(var f=0;f<a.attributes.length;f++){var g=a.attributes[f];/data-[0-9]+/.test(g.name)&&c.push(g.name)}for(f=0;f<c.length;f++)a.removeAttribute(c[f])}}function b(a,b){for(var c,d,e,f,g,h,i,j=[],k={},l="data-"+n+"-"+b,m=0,o=a.length;o>m;m++)if(c=a[m],"1"==b.charAt(m)){j=j.concat(c.selectors);for(var p in c.animations)c.animations.hasOwnProperty(p)&&(k[p]=c.animations[p])}for(var q=0,r=j.length;r>q;q++)if(d=j[q],e=document.querySelectorAll(d[0])){h=k[d[1]];for(var s=0,t=e.length;t>s;s++){f=e[s],g=JSON.parse(f.getAttribute(l)||"{}");for(i in h)";"!=h[i].charAt(h[i].length-1)&&(h[i]+=";"),g[i]=g[i]?h[i]+g[i]:h[i];f.setAttribute(l,JSON.stringify(g))}}}function c(a){var b,c="";if(!matchMedia)return d("1",a.length);for(var e=0,f=a.length;f>e;e++)b=a[e],c=c.concat(!b.media||matchMedia(b.media).matches?"1":"0");return c}function d(a,b){var c="";if(1>b)return c;for(;b>0;)1&b&&(c+=a),b>>=1,a+=a;return c}function e(a){a=a.trim();for(var b=(";"==a.charAt(a.length-1)?a.substring(0,a.length-1):a).split(";"),c=[],d=0,e=b.length;e>d;d++)c.push(b[d].split(":")[0]);return c}function f(){u(!0)}var g,h,i,j=[],k=30,l="",m={},n="ss",o=/@-skrollr-keyframes\s+([\w-]+)/g,p=/\s*\{\s*((?:[^{]+\{[^}]*\}\s*)+?)\s*\}/g,q=/([\w\-]+)\s*\{([^}]+)\}/g,r=/-skrollr-animation-name\s*:\s*([\w-]+)/g,s=function(a){var b=new XMLHttpRequest;try{b.open("GET",a,!1),b.send(null)}catch(c){window.XDomainRequest&&(b=new XDomainRequest,b.open("GET",a,!1),b.send(null))}return b.responseText},t=function(a,b){i=b;for(var c=0,d=a.length;d>c;c++){var e,f=a[c];if("LINK"===f.tagName){if(null===f.getAttribute("data-skrollr-stylesheet"))continue;e=s(f.href)}else e=f.textContent||f.innerText||f.innerHTML;e&&j.push({content:e,media:f.getAttribute("media"),animations:{},selectors:[]})}j.reverse();for(var g=0;g<j.length;g++)e=j[g].content,v(e,j[g].animations),w(e,j[g].selectors);u(!1)},u=function(d){var e,f=(new Date).getTime();return d&&g&&k>f-g?(window.clearTimeout(h),void(h=window.setTimeout(u,k))):(g=f,e=c(j),void(e!==l&&(a(),m[e]||(b(j,e),m[e]=!0),x(e),i.refresh(),l=e)))},v=function(a,b){o.lastIndex=0;for(var c,d,e,f;null!==(c=o.exec(a));)for(p.lastIndex=o.lastIndex,d=p.exec(a),q.lastIndex=0,f=b[c[1]]={};null!==(e=q.exec(d[1]));)f[e[1]]=e[2].replace(/[\n\r\t]/g,"")},w=function(a,b){r.lastIndex=0;for(var c,d,e;null!==(c=r.exec(a));){for(e=r.lastIndex;e--&&"{"!==a.charAt(e););for(d=e;d--&&"}"!==a.charAt(d-1););b.push([a.substring(d,e).replace(/[\n\r\t]/g,""),c[1]])}},x=function(a){for(var b,c="data-"+n+"-"+a,d="data-"+n+"-"+l,f=document.querySelectorAll("["+c+"], ["+d+"]"),g=function(a){i.setStyle(b,a,"")},h=function(a){return a.replace(/\[.*\]/,"")},j=0,k=f.length;k>j;j++){b=f[j];var m=JSON.parse(b.getAttribute(c))||{};for(var o in m)b.setAttribute("data-"+o,m[o]);var p=JSON.parse(b.getAttribute(d))||{};for(var q in p)e(p[q]).map(h).forEach(g)}};return{init:function(a){t(document.querySelectorAll("link, style"),a),window.addEventListener?window.addEventListener("resize",f,!1):window.attachEvent&&window.attachEvent("onresize",f)}}});